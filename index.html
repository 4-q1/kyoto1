<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>京都観光最適化</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    label, select, input { display: block; margin: 1rem 0; }
    button { padding: 0.5rem 1rem; }
    .result { margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>京都観光プラン最適化</h1>

  <label for="days">日数を選択:</label>
  <select id="days">
    <option value="1">1日</option>
    <option value="2">2日</option>
    <option value="3">3日</option>
  </select>

  <label for="spots">訪問したい場所を選択（複数可）:</label>
  <select id="spots" multiple size="10">
  </select>

  <button onclick="submitForm()">最適化プランを取得</button>

  <div class="result" id="result"></div>

  <script>
    const spots = [
      {"name": "京都駅"}, {"name": "清水寺"}, {"name": "伏見稲荷大社"},
      {"name": "金閣寺"}, {"name": "竹林の小径"}, {"name": "平等院"},
      {"name": "四条大橋"}, {"name": "安井金比羅宮"}, {"name": "蓮華王院三十三間堂"},
      {"name": "貴船神社"}, {"name": "高台寺"}, {"name": "産寧坂"}, {"name": "銀閣寺"},
      {"name": "八坂神社"}, {"name": "六波羅蜜寺"}, {"name": "京都御苑"}, {"name": "京都水族館"},
      {"name": "天龍寺"}, {"name": "龍安寺"}, {"name": "御金神社"}, {"name": "京都府立植物園"},
      {"name": "錦市場"}, {"name": "東福寺"}, {"name": "保津川下り"}, {"name": "京都国際マンガミュージアム"},
      {"name": "嵯峨野トロッコ列車"}, {"name": "金剛寺八坂庚申堂"}, {"name": "渡月橋"},
      {"name": "京都タワー"}, {"name": "南禅寺"}, {"name": "壬生寺"}, {"name": "花見小路通"},
      {"name": "漢字ミュージアム"}, {"name": "京都国立近代美術館"}
    ];

    const select = document.getElementById("spots");
    spots.forEach(s => {
      const opt = document.createElement("option");
      opt.value = s.name;
      opt.textContent = s.name;
      select.appendChild(opt);
    });

    function submitForm() {
      const days = document.getElementById("days").value;
      const selectedSpots = Array.from(select.selectedOptions).map(o => o.value);

      fetch('https://kotokyoto.onrender.com/optimize', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ days: Number(days), selected_spots: selectedSpots })
      })
      .then(res => res.json())
      .then(data => {
        const resDiv = document.getElementById("result");
        resDiv.innerHTML = "<h2>最適化結果</h2><pre>" + JSON.stringify(data, null, 2) + "</pre>";
      })
      .catch(err => {
        document.getElementById("result").textContent = "エラーが発生しました: " + err.message;
      });
    }
  </script>
</body>
</html>
